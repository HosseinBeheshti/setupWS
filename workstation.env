# ============================================================
# Cloudflare Zero Trust VPN Configuration (cloudflared + Egress)
# ============================================================
#
# This configuration file defines settings for cloudflared deployment
# with egress routing - routes remote WARP client traffic through your VPS.
#
# ARCHITECTURE:
#   - Remote WARP clients connect with Cloudflare One Agent
#   - Traffic routes: Client → Cloudflare Edge → cloudflared tunnel → VPS → Internet
#   - Gateway filtering applied to all traffic
#   - Exit IP = Your VPS public IP
#   - SSH access via Cloudflare Access (optional)
#
# MAIN SCRIPTS:
#   sudo ./setup_ztna.sh    - ONE-TIME VPS setup (installs & configures everything)
#
# SETUP WORKFLOW:
#   1. Complete Cloudflare Zero Trust dashboard setup (Part 1 in README.md):
#      - Create cloudflared tunnel (NOT WARP Connector)
#      - Copy tunnel token to CLOUDFLARE_TUNNEL_TOKEN below
#      - Add hostname routes (Networks → Routes → Hostname routes)
#      - Configure device enrollment
#      - Configure split tunnels (remove 100.64.0.0/10 from exclude list)
#   
#   2. Edit this file (workstation.env):
#      - Add your CLOUDFLARE_TUNNEL_TOKEN
#      - Set TUNNEL_NAME
#      - Set VPS IP address
#   
#   3. Run setup script:
#      sudo ./setup_ztna.sh
#      (Installs cloudflared, configures egress, enables NAT)
#   
#   4. Configure hostname routes in dashboard:
#      - Networks → Routes → Hostname routes
#      - Add route: Hostname = *, Tunnel = your-tunnel-name
#
#   5. Client setup:
#      - Install Cloudflare One Agent (WARP client)
#      - Authenticate with your email
#      - Traffic now exits through VPS IP
#
# USER ACCESS:
#   - Authentication: Gmail + One-time PIN (configured in Cloudflare dashboard)
#   - Traffic routing: Based on hostname routes
#   - Exit IP: Your VPS public IP (65.109.210.232)
#   - SSH: Via Cloudflare Access (configured separately)
#
# CONFIGURATION REQUIRED BELOW:
#   1. CLOUDFLARE_TUNNEL_TOKEN (from tunnel creation in dashboard)
#   2. TUNNEL_NAME (the name you gave your tunnel)
#   3. VPS IP address
#
# ============================================================

# ============================================================
# --- CLOUDFLARE TUNNEL CONFIGURATION ---
# ============================================================
# Cloudflare Tunnel token from dashboard
# Get this from: Networks → Connectors → Cloudflare Tunnels → Create tunnel → cloudflared
# After creating the tunnel, copy the token from the installation command
# Example: cloudflared service install eyJhIjoiNzk5...

CLOUDFLARE_TUNNEL_TOKEN=""

# Tunnel name (must match the name you created in dashboard)
# Example: vps-egress, my-tunnel, etc.
TUNNEL_NAME=""

# VPS public IP address (will be auto-detected if left empty)
VPS_PUBLIC_IP=""
